# 前端架构设计说明

## 1. 技术选型

### 1.1 核心技术栈
- **框架**: Vue 3.4+ (Composition API)
- **构建工具**: Vite 5.0+
- **包管理器**: npm
- **UI组件库**: Element Plus 2.4+
- **状态管理**: Pinia 2.1+
- **路由管理**: Vue Router 4.2+
- **HTTP客户端**: Axios 1.6+
- **工具库**: Lodash-es 4.17+

### 1.2 开发工具
- **代码规范**: ESLint + Prettier
- **类型检查**: TypeScript 5.0+
- **CSS预处理器**: SCSS
- **图标库**: @element-plus/icons-vue

### 1.3 选择理由
- Vue 3性能优异，Composition API提供更好的逻辑复用
- Vite提供快速的开发体验和构建速度
- Element Plus提供丰富的企业级UI组件
- Pinia提供简洁的状态管理方案
- 整体技术栈轻量，适合2核2G服务器部署

## 2. 工程结构

```
src/
├── api/                    # API接口层
│   ├── auth.js            # 认证相关接口
│   ├── user.js            # 用户管理接口
│   ├── resource.js        # 资源管理接口
│   ├── article.js         # 文章管理接口
│   └── index.js           # API统一导出
├── assets/                 # 静态资源
│   ├── images/            # 图片资源
│   └── styles/            # 样式文件
├── components/            # 公共组件
│   ├── common/            # 通用组件
│   │   ├── BaseTable.vue  # 基础表格组件
│   │   ├── BaseForm.vue   # 基础表单组件
│   │   └── BaseModal.vue  # 基础弹窗组件
│   └── business/          # 业务组件
│       ├── UserForm.vue   # 用户表单组件
│       ├── ArticleForm.vue # 文章表单组件
│       └── ResourceList.vue # 资源列表组件
├── composables/           # 组合式函数
│   ├── useAuth.js         # 认证相关逻辑
│   ├── usePermission.js   # 权限控制逻辑
│   └── useTable.js        # 表格相关逻辑
├── layouts/               # 布局组件
│   ├── DefaultLayout.vue  # 默认布局
│   └── AuthLayout.vue     # 认证页面布局
├── pages/                 # 页面组件
│   ├── auth/              # 认证相关页面
│   │   ├── Login.vue      # 登录页面
│   │   └── Register.vue   # 注册页面
│   ├── dashboard/         # 仪表盘
│   │   └── Index.vue      # 仪表盘首页
│   ├── user/              # 用户管理
│   │   ├── List.vue       # 用户列表
│   │   └── Edit.vue       # 用户编辑
│   ├── resource/          # 资源管理
│   │   ├── List.vue       # 资源列表
│   │   └── Detail.vue     # 资源详情
│   └── article/           # 文章管理
│       ├── List.vue       # 文章列表
│       ├── Create.vue     # 创建文章
│       └── Edit.vue       # 编辑文章
├── router/                # 路由配置
│   ├── index.js           # 路由主文件
│   ├── auth.js            # 认证路由
│   ├── user.js            # 用户管理路由
│   ├── resource.js        # 资源管理路由
│   └── article.js         # 文章管理路由
├── stores/                # 状态管理
│   ├── auth.js            # 认证状态
│   ├── user.js            # 用户状态
│   └── app.js             # 应用状态
├── utils/                 # 工具函数
│   ├── request.js         # HTTP请求封装
│   ├── auth.js            # 认证工具
│   ├── permission.js      # 权限工具
│   ├── validate.js        # 验证工具
│   └── format.js          # 格式化工具
├── App.vue               # 根组件
└── main.js               # 入口文件
```

## 3. 接口对接规范

### 3.1 请求响应格式
```javascript
// 请求格式
{
  "code": 0,           // 状态码，0表示成功
  "message": "",       // 消息描述
  "data": {}           // 业务数据
}

// 分页响应格式
{
  "code": 0,
  "message": "Success",
  "data": {
    "records": [],     // 数据列表
    "total": 0,        // 总条数
    "size": 20,        // 每页大小
    "current": 1,      // 当前页
    "pages": 0         // 总页数
  }
}
```

### 3.2 HTTP状态码映射
- 200: 请求成功
- 400: 请求参数错误
- 401: 未授权，需要登录
- 403: 权限不足
- 404: 资源不存在
- 429: 请求频率限制
- 500: 服务器内部错误

### 3.3 业务状态码定义
- 0: 成功
- 40001: 用户名或密码错误
- 40002: 用户被禁用
- 40003: 用户不存在
- 40004: 用户名已存在
- 40005: 邮箱格式错误
- 40006: 权限不足
- 50001: 参数验证失败
- 50002: 资源不存在
- 50003: 操作失败

## 4. 接口设计

### 4.1 认证接口
```javascript
// 用户登录
POST /api/auth/login
{
  "username": "string",
  "password": "string"
}

// 用户注册
POST /api/auth/register
{
  "username": "string",
  "nickname": "string", 
  "password": "string",
  "confirmPassword": "string",
  "email": "string"
}

// 用户登出
POST /api/auth/logout

// 获取当前用户信息
GET /api/auth/profile
```

### 4.2 用户管理接口
```javascript
// 分页查询用户列表
GET /api/users?keyword=&current=1&size=10

// 修改用户信息
PUT /api/users/:id
{
  "nickname": "string",
  "email": "string",
  "password": "string",
  "role": 0,
  "enabled": true
}

// 删除用户
DELETE /api/users/:id

// 修改个人信息
PUT /api/users/profile
{
  "nickname": "string",
  "email": "string",
  "password": "string"
}
```

### 4.3 资源管理接口
```javascript
// 分页查询资源列表
GET /api/resources?keyword=&from=&startTime=&endTime=&current=1&size=10

// 获取资源详情
GET /api/resources/:id
```

### 4.4 文章管理接口
```javascript
// 分页查询文章列表
GET /api/articles?keyword=&current=1&size=10

// 获取文章详情
GET /api/articles/:id

// 创建文章
POST /api/articles
{
  "title": "string",
  "content": "string",
  "description": "string",
  "resourceIds": ["string"]
}

// 修改文章
PUT /api/articles/:id
{
  "title": "string",
  "content": "string", 
  "description": "string",
  "resourceIds": ["string"],
  "status": 0
}

// 删除文章
DELETE /api/articles/:id
```

## 5. 权限控制设计

### 5.1 角色权限映射
```javascript
const rolePermissions = {
  0: ['dashboard'], // 普通用户
  1: ['dashboard', 'user', 'resource', 'article'], // 系统管理员
  2: ['dashboard', 'user', 'resource', 'article'], // 超级管理员
  3: ['dashboard', 'resource', 'article'] // 编辑
}

const operationPermissions = {
  'user:list': [1, 2],      // 用户列表
  'user:edit': [1, 2],      // 用户编辑
  'user:delete': [1, 2],    // 用户删除
  'resource:list': [1, 2, 3], // 资源列表
  'resource:view': [1, 2, 3], // 资源查看
  'article:list': [1, 2, 3],  // 文章列表
  'article:create': [1, 2, 3], // 文章创建
  'article:edit': [1, 2, 3],   // 文章编辑
  'article:delete': [1, 2]     // 文章删除
}
```

### 5.2 权限控制实现
- 路由级别权限控制
- 组件级别权限控制
- 接口级别权限控制
- 按钮级别权限控制

## 6. 最佳实践说明

### 6.1 代码规范
- 使用ESLint + Prettier保持代码风格一致
- 组件命名采用PascalCase
- 文件命名采用kebab-case
- 使用TypeScript提供类型安全

### 6.2 性能优化
- 路由懒加载
- 组件按需加载
- 图片懒加载
- 虚拟滚动（大数据列表）
- 防抖节流处理

### 6.3 安全措施
- 输入验证和过滤
- XSS防护
- CSRF防护
- 敏感信息加密传输
- 请求频率限制

### 6.4 用户体验
- 加载状态提示
- 错误信息友好展示
- 操作确认弹窗
- 表单验证实时反馈
- 响应式设计

### 6.5 错误处理
- 全局错误捕获
- 网络错误处理
- 业务错误处理
- 用户友好的错误提示

### 6.6 数据管理
- 使用Pinia进行状态管理
- 合理使用本地存储
- 数据缓存策略
- 数据同步机制

## 7. 部署说明

### 7.1 构建配置
```javascript
// vite.config.js
export default defineConfig({
  build: {
    outDir: 'dist',
    assetsDir: 'assets',
    sourcemap: false,
    minify: 'terser',
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['vue', 'vue-router', 'pinia'],
          elementPlus: ['element-plus']
        }
      }
    }
  }
})
```

### 7.2 环境配置
- 开发环境: .env.development
- 生产环境: .env.production
- 测试环境: .env.test

### 7.3 部署要求
- Node.js 18+
- 支持静态文件服务
- 配置反向代理
- 启用Gzip压缩
- 配置缓存策略

## 8. 开发流程

### 8.1 开发环境搭建
```bash
# 安装依赖
npm install

# 启动开发服务器
npm run dev

# 构建生产版本
npm run build

# 代码检查
npm run lint

# 类型检查
npm run type-check
```

### 8.2 开发规范
- 遵循Git提交规范
- 代码审查机制
- 单元测试覆盖
- 文档及时更新

### 8.3 测试策略
- 单元测试: Vitest
- 组件测试: Vue Test Utils
- E2E测试: Playwright
- 性能测试: Lighthouse
